실습: 첫 번째 앙클레이브(Enclave) 구동하기

### 1. 환경 준비 (EC2 인스턴스 생성) ###
아무 인스턴스나 되는 게 아니라 Nitro 기반 인스턴스여야 합니다.
* 사양: c5.xlarge 이상의 인스턴스 추천 (최소 4 vCPU 이상 필요).
* 설정: 인스턴스 시작 시 Enclave 지원 활성화 옵션을 반드시 'Enable'로 체크해야 합니다.
* 도구 설치: aws-nitro-enclaves-cli를 설치하여 앙클레이브 제어 준비를 마칩니다.

### 2. 소스 코드 및 도커 이미지 생성 ###
* 앙클레이브 내부에서 실행할 로직(비식별 처리 로직 등)을 작성합니다.
* 언어: 말씀하신 Rust나 Java로 작성된 간단한 "Hello Enclave" 앱.
* 패키징: 이 앱을 일반적인 Docker 이미지로 빌드합니다. 앙클레이브는 운영체제 통째로 들어가는 게 아니라, 이 도커 이미지를 기반으로 구동됩니다.

### 3. EIF(Enclave Image File) 변환 ###
도커 이미지를 앙클레이브 전용 파일 형식인 EIF로 변환합니다.
* 명령어: nitro-cli build-enclave --docker-uri <이미지태그> --output-file sample.eif
* 중요: 이 과정에서 PCR(Platform Configuration Registers)이라는 해시값이 생성됩니다. 이게 나중에 "이 금고 안의 코드는 변조되지 않았음"을 증명하는 디지털 지문이 됩니다.

### 4. 앙클레이브 실행 및 리소스 할당 ###
부모 EC2의 자원 중 일부를 떼어서 앙클레이브를 가동합니다.
* 명령어: nitro-cli run-enclave --eif-path sample.eif --cpu-count 2 --memory 512
* 결과: 이제 부모 서버와 격리된, 네트워크도 안 되고 관리자도 못 들어가는 독립된 공간이 서버 내부에 생깁니다.

### 5. 통신 테스트 (vsock) ###
* 앙클레이브는 인터넷이 안 되므로, 부모 서버와 가상 소켓(vsock) 통신으로 데이터를 주고받습니다.
* 부모 서버에서 비식별화할 샘플 데이터를 소켓으로 쏴주고, 앙클레이브가 이를 처리해 다시 돌려주는 과정을 확인하며 실습을 마무리합니다.
